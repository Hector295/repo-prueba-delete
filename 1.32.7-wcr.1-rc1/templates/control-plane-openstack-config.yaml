apiVersion: rke-machine-config.cattle.io/v1
kind: OpenstackConfig
metadata:
  name: machine-control-plane-{{ .Values.cluster.name }}
  namespace: fleet-default
activeTimeout: "{{ .Values.controlPlaneNodes.activeTimeout | default "200" }}"
applicationCredentialId: "{{ .Values.infraConfig.applicationCredentialId | default "" }}"
applicationCredentialName: "{{ .Values.infraConfig.applicationCredentialName | default "" }}"
applicationCredentialSecret: "{{ .Values.infraConfig.applicationCredentialSecret | default "" }}"
authUrl: {{ .Values.infraConfig.authUrl | quote }}
availabilityZone: {{ .Values.infraConfig.availabilityZone | default "nova" }}
bootFromVolume: {{ .Values.controlPlaneNodes.bootFromVolume | default "false" }}
cacert: ""
configDrive: {{ .Values.controlPlaneNodes.configDrive | default "false" }}
domainId: "{{ .Values.infraConfig.domainId | default "" }}"
{{- if .Values.infraConfig.domainName }}
domainName: {{ .Values.infraConfig.domainName }}
{{- end }}
endpointType: {{ .Values.infraConfig.endpointType | default "publicURL" }}
flavorId: "{{ .Values.controlPlaneNodes.flavorId | default "" }}"
{{- if .Values.controlPlaneNodes.flavorName }}
flavorName: {{ .Values.controlPlaneNodes.flavorName | quote }}
{{- end }}
floatingipPool: "{{ .Values.controlPlaneNodes.floatingipPool | default "" }}"
imageId: "{{ .Values.controlPlaneNodes.imageId | default "" }}"
{{- if .Values.controlPlaneNodes.imageName }}
imageName: {{ .Values.controlPlaneNodes.imageName | quote }}
{{- end }}
insecure: {{ .Values.infraConfig.insecure | default "false" }}
ipVersion: "{{ .Values.infraConfig.ipVersion | default "4" }}"
keypairName: {{ .Values.infraConfig.keypairName }}
netName: {{ .Values.infraConfig.netName }}
novaNetwork: {{ .Values.infraConfig.novaNetwork | default "false" }}
password: "{{ (lookup "v1" "Secret" .Values.infraConfig.password.secret.namespace .Values.infraConfig.password.secret.name).data.password | b64dec }}"
privateKeyFile: ""
region: {{ .Values.infraConfig.region }}
sshPort: {{ .Values.infraConfig.sshPort | default "22" | quote }}
sshUser: {{ .Values.infraConfig.sshUser }}
secGroups: {{ .Values.controlPlaneNodes.securityGroups }}
tenantDomainId: "{{ .Values.infraConfig.tenantDomainId | default "" }}"
tenantDomainName: "{{ .Values.infraConfig.tenantDomainName | default "" }}"
tenantId: "{{ .Values.infraConfig.tenantId | default "" }}"
tenantName: {{ .Values.infraConfig.tenantName }}
userDataFile: ""
userDomainId: "{{ .Values.infraConfig.userDomainId | default "" }}"
userDomainName: "{{ .Values.infraConfig.userDomainName | default "" }}"
userId: "{{ .Values.infraConfig.userId | default "" }}"
username: {{ .Values.infraConfig.username }}
volumeDevicePath: ""
volumeId: ""
volumeName: ""
volumeSize: "{{ .Values.controlPlaneNodes.rootVolume.sizeGiB | default "" }}"
volumeType: "{{ .Values.controlPlaneNodes.rootVolume.volumeType | default "" }}"